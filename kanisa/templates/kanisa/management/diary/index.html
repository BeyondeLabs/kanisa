{% extends 'kanisa/management/base.html' %}

{% load url from future %}

{% block content %}
{% if events_to_schedule %}
<p><a href="{% url 'kanisa_manage_diary_schedule_weeks_regular_event' %}" class="btn btn-large btn-primary">Schedule this week's regular events &raquo;</a></p>
{% endif %}

<hr />

<h2>Week Beginning {{ monday|date:"jS F Y" }}</h2>

<table class="table table-striped kanisa_diary">
  <thead>
    <tr>
      <th>Day</th>
      <th colspan="3">Available Events</th>
      <th colspan="4">Scheduled Events</th>
    </tr>
  </thead>
  <tbody>
    {% for entry in calendar %}
    <tr>
      <td>
        <strong>{{ entry.dayname }}</strong><br />
        {{ entry.date|date:"jS F" }}
      </td>
      <td>
      {% for e in entry.regular_events %}
      {{ e.start_time }}<br />
      {% empty %}
      <em>None</em>
      {% endfor %}
      </td>
      <td>
      {% for e in entry.regular_events %}
      <a href="{% url 'kanisa_manage_diary_regular_update' e.pk %}">{{ e }}</a><br />
      {% endfor %}
      </td>
      <td>
      {% for e in entry.regular_events %}
        <a href="{% url 'kanisa_manage_diary_schedule_regular_event' e.pk entry.date|date:"Ymd" %}" class="btn btn-mini btn-success">Schedule</a>
      <br />
      {% endfor %}
      </td>
      <td>
      {% for e in entry.scheduled_events %}
      {{ e.start_time }}<br />
      {% endfor %}
      </td>
      <td>
      {% for e in entry.scheduled_events %}
      <a href="{% url 'kanisa_manage_diary_scheduled_update' e.pk %}">{{ e }}</a><br />
      {% endfor %}
      </td>
      <td>
      {% for e in entry.scheduled_events %}
        <a href="{% url 'kanisa_manage_diary_cancel_scheduled_event' e.pk %}" class="btn btn-mini btn-danger">Cancel</a>
      <br />
      {% endfor %}
      </td>
      <td><a href="{% url 'kanisa_manage_diary_scheduled_create' %}?date={{ entry.date|date:"Ymd" }}" title="Create an event on {{ entry.date|date:"jS F Y"}}"><i class="icon-plus-sign"></i></a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<ul class="pager">
  <li class="previous">
    <a href="?date={{ previousdate }}">&larr; Older</a>
  </li>
  <li class="next">
    <a href="?date={{ nextdate }}">Newer &rarr;</a>
  </li>
</ul>

<p class="pull-right"><a href="{% url 'kanisa_manage_diary_scheduled_create' %}" class="btn btn-primary">Schedule a new event &raquo;</a></p>

{% endblock %}
